[m,n]=size(A);
Q=eye(m);
A1=A;

p=1;
for q=2:m,
		c=1/sqrt(1+(A1(q,p)/A1(p,p))^2);
		s=c*A1(q,p)/A1(p,p);
		Eye=eye(m);
		Eye(p,p)=c;
		Eye(p,q)=s;
		Eye(q,p)=-s;
		Eye(q,q)=c;
		A1=Eye*A1;
		Q=Eye*Q;
end

Q=-transpose(Q)
R=-A1

==========
A =

     1     1     1     1
     2     4     3    -1
    -1     1    -1     1
     4    -5     6    -7
     1     0     1     0

x =

    1
    2
   -1
    4
    1

P =

   -0.2085   -0.4170    0.2085   -0.8341   -0.2085
   -0.4170    0.8561    0.0720   -0.2878   -0.0720
    0.2085    0.0720    0.9640    0.1439    0.0360
   -0.8341   -0.2878    0.1439    0.4244   -0.1439
   -0.2085   -0.0720    0.0360   -0.1439    0.9640

P*x =

   -4.7958
    0.0000
   -0.0000
    0.0000
         0

Q =

    0.2085    0.4170   -0.2085    0.8341    0.2085
   -0.8944    0.4472         0         0         0
    0.1826    0.3651    0.9129         0         0
   -0.3482   -0.6963    0.3482    0.5222         0
   -0.0445   -0.0889    0.0445   -0.1778    0.9780

Q*x =

   -4.7958
         0
    0.0000
    0.0000
         0

