function [Q,d]=jacobi(A)
% [Q,d] = jacobi(A)
%
% Given a symmetric matrix A, jacobi computes the eignvectors Q and
% eigenvalues d of A by using Classical Jacobi method.

[m,n]=size(A);
Q=eye(n);
off=norm(A,'fro')^2-norm(diag(A))^2;

while off > 10^(-12)
   [stuff,p]=max(max(abs(A'-diag(diag(A)))));
   [stuff,q]=max(max(abs(A-diag(diag(A)))));
   
   if p == q
      [stuff,p]=max(max(abs(triu(A)-diag(diag(A)))));
   end
   
   [c,s]=sym2(A,p,q);
   
   J=eye(m);
   J(p,p)=c;
   J(p,q)=-s;
   J(q,p)=s;
   J(q,q)=c;
   
   A=J'*A*J;
   Q=Q*J;
   off=norm(A,'fro')^2-norm(diag(A))^2;
end
d=diag(A);

=========================

A=hilb(8)

A =

  Columns 1 through 8

    1.0000    0.5000    0.3333    0.2500    0.2000    0.1667    0.1429    0.1250
    0.5000    0.3333    0.2500    0.2000    0.1667    0.1429    0.1250    0.1111
    0.3333    0.2500    0.2000    0.1667    0.1429    0.1250    0.1111    0.1000
    0.2500    0.2000    0.1667    0.1429    0.1250    0.1111    0.1000    0.0909
    0.2000    0.1667    0.1429    0.1250    0.1111    0.1000    0.0909    0.0833
    0.1667    0.1429    0.1250    0.1111    0.1000    0.0909    0.0833    0.0769
    0.1429    0.1250    0.1111    0.1000    0.0909    0.0833    0.0769    0.0714
    0.1250    0.1111    0.1000    0.0909    0.0833    0.0769    0.0714    0.0667
    
[Q,d]=jacobi(A)

Q =

  Columns 1 through 8 

    0.7203   -0.6295    0.0865   -0.0003   -0.0207    0.0037   -0.0002    0.2775
    0.4325    0.1257   -0.5501    0.0158    0.2668   -0.0839    0.0068   -0.6449
    0.3188    0.2864    0.3363   -0.1491   -0.6281    0.4145   -0.0495   -0.3351
    0.2552    0.3276    0.4592    0.5174    0.0394   -0.5801    0.0909   -0.0512
    0.2139    0.3321    0.2757   -0.7352    0.4161   -0.1185    0.1394    0.1440
    0.1845    0.3235    0.0113    0.2747    0.3628    0.4187   -0.6359    0.2729
    0.1625    0.3103   -0.2490    0.2514    0.0186    0.3542    0.7063    0.3570
    0.1453    0.2956   -0.4773   -0.1748   -0.4767   -0.4121   -0.2581    0.4116
    
d =

    1.6959
    0.2981
    0.0015
    0.0000
    0.0001
    0.0000
    0.0000
    0.0262
